<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üå± Daily Habit Tracker</title>
  <style>
    /* ---------------- Body/Layout ---------------- */
    body {
      margin: 0;
      font-family: "Poppins", sans-serif;
      background: #f4f5f7;
      display: flex;
      justify-content: center;
      min-height: 100vh;
    }
    .app {
      background: white;
      width: 90%;
      max-width: 500px;
      margin: 40px 0;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    h1, h2 { text-align: center; color: #1f2937; }

    form { display: flex; gap: 10px; margin-bottom: 15px; }
    input[type="text"], input[type="password"], input[type="date"] {
      flex: 1; padding: 8px; border: 1px solid #ccc; border-radius: 6px;
    }
    button {
      padding: 8px 12px; border: none; border-radius: 6px;
      background-color: #2563eb; color: white; cursor: pointer;
    }
    button:hover { background-color: #1d4ed8; }

    .habit-card {
      background: #f9fafb; border: 1px solid #ddd;
      border-radius: 8px; padding: 10px 12px; margin-bottom: 10px;
    }
    .habit-card .top-row { display: flex; justify-content: space-between; }
    .habit-title { font-weight: 500; color: #111827; }
    .actions { display: flex; gap: 8px; }
    button.done { background-color: #16a34a; }
    button.delete-btn { background-color: #ef4444; }
    button.delete-btn:hover { background-color: #dc2626; }

    .details {
      margin-top: 6px; font-size: 0.9rem; color: #374151;
      background: #f3f4f6; padding: 6px 8px; border-radius: 4px;
    }

    .progress-rings-wrapper {
      display: flex; flex-wrap: wrap; justify-content: center; gap: 20px;
      margin-top: 15px;
    }
    .progress-item { text-align: center; }
    .progress-label { margin-top: 6px; font-size: 0.9rem; font-weight: 600; }

    .congrats-tab {
      position: fixed; bottom: 20px; right: 20px;
      background-color: #4ade80; color: white;
      padding: 12px 20px; border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2); font-weight: 600;
    }

    .login-section {
      background: white; padding: 30px; border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      width: 90%; max-width: 400px; margin: 60px auto; text-align: center;
    }
    .login-section form { display: flex; flex-direction: column; gap: 10px; }
    .login-section input { padding: 8px; border: 1px solid #ccc; border-radius: 6px; }
    .login-section button { padding: 8px; border-radius: 6px; }

    .button-group {
      display: flex; justify-content: center; gap: 20px;
    }
    .button-group button { padding: 10px 20px; border-radius: 8px; }
    .button-group .secondary { background-color: #f59e0b; }
  </style>
</head>
<body>

  <!-- Home Page -->
  <div id="home" class="login-section">
    <h1>üå± Daily Habit Tracker</h1>
    <p>Welcome! Start tracking your daily growth.</p>
    <div class="button-group">
      <button onclick="showPage('login')">Login</button>
      <button class="secondary" onclick="showPage('register')">Register</button>
    </div>
  </div>

  <!-- Login Page -->
  <div id="login" class="login-section" style="display:none;">
    <h1>üëã Welcome</h1>
    <form id="loginForm">
      <input id="loginUser" type="text" placeholder="Username" required />
      <input id="loginPass" type="password" placeholder="Password" required />
      <button type="submit">Login</button>
    </form>
    <p>New here? <a href="#" onclick="showPage('register')">Register</a></p>
  </div>

  <!-- Register Page -->
  <div id="register" class="login-section" style="display:none;">
    <h1>üìù Register</h1>
    <form id="registerForm">
      <input id="regUser" type="text" placeholder="New Username" required />
      <input id="regPass" type="password" placeholder="Password" required />
      <button type="submit">Register</button>
    </form>
    <p>Already have an account? <a href="#" onclick="showPage('login')">Login</a></p>
  </div>

  <!-- Dashboard -->
  <div id="dashboard" class="app" style="display:none;">
    <h1>üå± Daily Habit Tracker</h1>
    <h2 id="welcomeUser"></h2>

    <form id="habit-form">
      <input type="text" id="habit-input" placeholder="Enter a new habit..." required />
      <button type="submit">Add Habit</button>
    </form>
    <div id="habit-list"></div>

    <h2>üìä Progress Overview</h2>
    <div id="progressRingsContainer" class="progress-rings-wrapper"></div>
  </div>

  <script>
    // --- Global ---
    let users = JSON.parse(localStorage.getItem("users") || "[]");
    let currentUser = localStorage.getItem("currentUser") || null;
    let selectedDate = new Date().toISOString().split("T")[0];
    const emojis = ["üéâ","üëè","üåü","ü•≥","üí™","üî•","üéØ","üôå","üèÜ","üòä"];

    function showPage(id) {
      ["home","login","register","dashboard"].forEach(p => 
        document.getElementById(p).style.display = "none"
      );
      document.getElementById(id).style.display = "block";
    }

    if (currentUser) {
      document.getElementById("welcomeUser").textContent = "üëã Hello, " + currentUser;
      showPage("dashboard");
    }

    // --- Register ---
    document.getElementById("registerForm").addEventListener("submit", e => {
      e.preventDefault();
      const username = regUser.value.trim();
      const password = regPass.value.trim();
      if (users.find(u => u.username === username)) return alert("User exists!");
      users.push({username, password, habits: []});
      localStorage.setItem("users", JSON.stringify(users));
      alert("Registered!");
      showPage("login");
    });

    // --- Login ---
    document.getElementById("loginForm").addEventListener("submit", e => {
      e.preventDefault();
      const username = loginUser.value.trim();
      const password = loginPass.value.trim();
      const u = users.find(u => u.username===username && u.password===password);
      if (!u) return alert("Invalid login");
      currentUser = username;
      localStorage.setItem("currentUser", username);
      document.getElementById("welcomeUser").textContent = "üëã Hello, " + username;
      showPage("dashboard");
      renderHabits();
    });

    // --- Habits ---
    const habitForm = document.getElementById("habit-form");
    const habitInput = document.getElementById("habit-input");
    const habitList = document.getElementById("habit-list");

    habitForm.addEventListener("submit", e => {
      e.preventDefault();
      const name = habitInput.value.trim();
      if (!name) return;
      const u = users.find(u => u.username===currentUser);
      u.habits.push({id:Date.now(), name, completed:[], streak:0});
      localStorage.setItem("users", JSON.stringify(users));
      habitInput.value="";
      renderHabits();
    });

    function completeHabit(id) {
      const u = users.find(u => u.username===currentUser);
      const h = u.habits.find(h => h.id===id);
      const done = h.completed.find(d => d.date===selectedDate);
      if (done) {
        h.completed = h.completed.filter(d => d.date!==selectedDate);
      } else {
        const details = prompt("Enter details:");
        h.completed.push({date:selectedDate, details});
        h.streak = h.completed.length;
        showCongrats(selectedDate);
      }
      localStorage.setItem("users", JSON.stringify(users));
      renderHabits();
    }

    function deleteHabit(id) {
      const u = users.find(u => u.username===currentUser);
      u.habits = u.habits.filter(h => h.id!==id);
      localStorage.setItem("users", JSON.stringify(users));
      renderHabits();
    }

    function renderHabits() {
      const u = users.find(u => u.username===currentUser);
      habitList.innerHTML="";
      u.habits.forEach(habit=>{
        const done = habit.completed.find(d=>d.date===selectedDate);
        const div=document.createElement("div");
        div.className="habit-card";
        div.innerHTML=`
          <div class="top-row">
            <span class="habit-title">${habit.name} üî• ${habit.completed.length} days</span>
            <div class="actions">
              <button class="${done?"done":""}" onclick="completeHabit(${habit.id})">${done?"Done":"Mark Done"}</button>
              <button class="delete-btn" onclick="deleteHabit(${habit.id})">üóë Delete</button>
            </div>
          </div>
          ${done?.details ? `<p class="details">Details: ${done.details}</p>`:""}
        `;
        habitList.appendChild(div);
      });
      renderProgress(u.habits);
    }

    function renderProgress(habits) {
      const c=document.getElementById("progressRingsContainer");
      c.innerHTML="";
      habits.forEach(h=>{
        const done=h.completed.find(d=>d.date===selectedDate);
        const percent=done?100:Math.min((h.streak/30)*100,100);
        const radius=40, circ=2*Math.PI*radius;
        const offset=circ-(percent/100)*circ;
        const wrapper=document.createElement("div");
        wrapper.className="progress-item";
        wrapper.innerHTML=`
          <div style="position:relative;width:100px;height:100px;display:flex;align-items:center;justify-content:center;">
            <svg width="100" height="100">
              <circle stroke="#e5e7eb" stroke-width="10" fill="transparent" r="${radius}" cx="50" cy="50"></circle>
              <circle stroke="#2563eb" stroke-width="10" fill="transparent" r="${radius}" cx="50" cy="50"
                style="stroke-dasharray:${circ} ${circ}; stroke-dashoffset:${offset};
                transform:rotate(-90deg); transform-origin:50% 50%;" />
            </svg>
            <span style="position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);">${percent.toFixed(0)}%</span>
          </div>
          <div class="progress-label">${h.name}</div>
        `;
        c.appendChild(wrapper);
      });
    }

    function showCongrats(date) {
      const div=document.createElement("div");
      div.className="congrats-tab";
      div.textContent=emojis[Math.floor(Math.random()*emojis.length)]+" Congratulations! Task done for "+date;
      document.body.appendChild(div);
      setTimeout(()=>div.remove(),2000);
    }
  </script>
</body>
</html>
